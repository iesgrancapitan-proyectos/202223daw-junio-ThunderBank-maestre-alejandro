@using ThunderBank.Models.DTO;
@model DTOCrearTarjeta

@{
    ViewData["Title"] = "Crear nueva tarjeta";
    Layout = "~/Views/Shared/_LayoutCliente.cshtml";
}

@if (Model.Cuentas.Where(x=>x.Activa == true).ToList().Count > 0){
    <h1>Crear tarjeta</h1>
    <form asp-controller="Tarjeta" asp-action="Crear" class="text-white">
        <input type="hidden" asp-for="FechaDeCreacion" value="@DateTime.Now" />
        <input type="hidden" asp-for="FechaDeCaducidad" value="@DateTime.Now.AddYears(3)" />
        <input type="hidden" asp-for="Cvc" value="@Model.Cvc" />
        <input type="hidden" asp-for="Pin" value="@Model.Pin" />
        <input type="hidden" asp-for="Estado" value="@Model.Estado" />

        <label for="cuenta">Selecciona una cuenta:</label>
        <select name="NumeroDeCuenta" id="cuenta" asp-for="NumeroDeCuenta">
            @foreach (var cuenta in Model.Cuentas.Where(x=>x.Activa == true))
            {
                <option value="@cuenta.Numero">@cuenta.Numero</option>
            }
        </select>

        <br />
        <label class="form-label">Anota tu código pin</label><br>
        <input type="text" disabled placeholder="@Model.Pin" asp-for="Pin" />

        <div class="mt-3">
            <button type="submit" class="btn btn-success">Crear tarjeta</button>
            <a asp-action="Index" class="btn btn-danger">Cancelar</a>
        </div>
    </form>
}
else
{
    <h1>Ha ocurrido un error</h1>
    <span class="text-white">Lo sentimos, ha ocurrido un error, lo mas seguro es que está intentando crear una tarjeta sin tener una cuenta</span>
    <script>
        swal({
            title: "Error",
            text: "Lo sentimos, ha ocurrido un error. Es posible que esté intentando crear una tarjeta sin tener una cuenta.",
            icon: "error",
            button: "Aceptar"
        });
    </script>
}
